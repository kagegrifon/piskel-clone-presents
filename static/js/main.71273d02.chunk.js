(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,function(e,t,a){e.exports=a(28)},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(9),i=a.n(o),l=a(2),c=a(3),s=a(5),u=a(4),m=a(1),d=a(6),f={kebabCaseToCamelCase:function(e){return e.replace(/(-)(.)/g,function(e,t,a){return a.toUpperCase()})},getRandomID:function(){return Math.floor(1e16*Math.random())+Date.now()}},h={makeNewMatrix:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"transparent",a=new Array(e).fill(t);return new Array(e).fill(null).map(function(){return a.slice()})},getOffsetValues:function(e){var t={};document.defaultView&&document.defaultView.getComputedStyle&&(t.stylePaddingLeft=parseInt(document.defaultView.getComputedStyle(e,null).paddingLeft,10)||0,t.stylePaddingTop=parseInt(document.defaultView.getComputedStyle(e,null).paddingTop,10)||0,t.styleBorderLeft=parseInt(document.defaultView.getComputedStyle(e,null).borderLeftWidth,10)||0,t.styleBorderTop=parseInt(document.defaultView.getComputedStyle(e,null).borderTopWidth,10)||0);var a=document.body.parentNode;return t.htmlTop=a.offsetTop,t.htmlLeft=a.offsetLeft,t},getMouse:function(e,t,a){var n=0,r=0,o=a;if(void 0!==o.offsetParent)do{n+=o.offsetLeft,r+=o.offsetTop}while(null!==(o=o.offsetParent));return n+=t.stylePaddingLeft+t.styleBorderLeft+t.htmlLeft,r+=t.stylePaddingTop+t.styleBorderTop+t.htmlTop,{x:e.pageX-n,y:e.pageY-r}},paintColors:function(e,t){var a=t.length,n=Math.round(e.width/a),r=e.getContext("2d");t.forEach(function(e,t){return e.forEach(function(e,a){r.fillStyle=e,r.fillRect(a*n,t*n,n,n)})})},paintDefaultScreen:function(e,t){for(var a=2*t,n=Math.round(e.width/a),r=e.getContext("2d"),o=0;o<a;o+=1)for(var i=0;i<a;i+=1)r.fillStyle=(o+i)%2===0?"#666666":"#888888",r.fillRect(i*n,o*n,n,n)}};a(16);var v=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("h1",{className:"header__logo"},"Piskel Clone"),r.a.createElement("p",{className:"header__piskel-title"},"new Piskel"))},p=a(7),C=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).canvas=r.a.createRef(),a.colorTypesByMouseButton={rightMouseButton:{code:2,colorType:"secondary"},leftMouseButton:{code:1,colorType:"primary"}},a.handleClick=a.handleClick.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.canvas.current,t=this.props.activeFrame,a=e.getBoundingClientRect();e.setAttribute("width",a.width),e.setAttribute("height",a.height),h.paintDefaultScreen(e,t.frameColors.length)}},{key:"componentDidUpdate",value:function(){var e=this.props.activeFrame,t=this.canvas.current;h.paintDefaultScreen(t,e.frameColors.length),h.paintColors(t,e.frameColors)}},{key:"getActiveColorTypeByMouseButton",value:function(e){var t=this.colorTypesByMouseButton,a=Object.keys(t).find(function(a){return t[a].code===e.buttons});return t[a].colorType}},{key:"getPixelPos",value:function(e){var t=this.canvas.current,a=this.props.activeFrame,n=h.getOffsetValues(t),r=h.getMouse(e,n,t),o=a.frameColors.length,i=Math.round(t.width/o);return{x:Math.floor(r.x/i),y:Math.floor(r.y/i)}}},{key:"getMatrixChangesForArial",value:function(e,t){for(var a=this.props.activeModeOpt.toolArial,n=[],r=this.props.activeFrame.frameColors.length,o=0;o<a;o+=1)for(var i=0;i<a;i+=1)e.x+i>=0&&e.y+o>=0&&e.x+i<r&&e.y+o<r&&n.push({pos:{x:e.x+i,y:e.y+o},color:t});return n}},{key:"penAction",value:function(e){var t=this.props.activeColors,a=this.getPixelPos(e),n=this.getActiveColorTypeByMouseButton(e);return this.getMatrixChangesForArial(a,t[n])}},{key:"eraserAction",value:function(e){var t=this.getPixelPos(e);return this.getMatrixChangesForArial(t,"transparent")}},{key:"bucketAction",value:function(e){return{specialActionType:"fill",specialActionOpt:{color:this.props.activeColors[this.getActiveColorTypeByMouseButton(e)]}}}},{key:"colorPickerAction",value:function(e){var t=this.props,a=t.activeFrame,n=t.handles.handleSetActiveColors,r=this.getActiveColorTypeByMouseButton(e),o=this.getPixelPos(e);n(Object(p.a)({},r,a.frameColors[o.y][o.x]))}},{key:"handleClick",value:function(e){var t=this,a=this.props.activeModeOpt.tool,n=this.props.handles.handleFrameMatrixChange;if(Object.keys(this.colorTypesByMouseButton).some(function(a){return t.colorTypesByMouseButton[a].code===e.buttons})){var r=function(){},o="".concat(a,"Action");if("colorPicker"===a)this.colorPickerAction(e),r=function(e){return t.colorPickerAction(e)};else{var i=this[o](e);n(i),"bucket"!==a&&(r=function(e){var a=t[o](e);a.length>0&&n(a)})}var l=function e(t){t.target.removeEventListener("mousemove",r),t.target.removeEventListener("mouseup",e),t.target.removeEventListener("mouseout",e)};e.target.addEventListener("mousemove",r),e.target.addEventListener("mouseup",l),e.target.addEventListener("mouseout",l)}}},{key:"render",value:function(){var e=this.props.activeModeOpt.tool;return r.a.createElement("div",{className:"piskel-block"},r.a.createElement("div",{className:"square-container ".concat(e,"-mode")},r.a.createElement("canvas",{className:"piskel-canvas",ref:this.canvas,onMouseDown:this.handleClick,onContextMenu:function(e){return e.preventDefault()}})))}}]),t}(n.Component),y=(a(17),C),b=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleClick",value:function(e){(0,this.props.handles.handleSetActiveToolArial)(+e.target.dataset.size)}},{key:"render",value:function(){var e=this,t=this.props.activeSize,a=[0,1,2,3].map(function(a){var n=t===a+1;return r.a.createElement("li",{onClick:e.handleClick,className:"pixel-size-container__pixel-size-variant ".concat(n?"active":""),"data-size":a+1,key:a,role:"option",tabIndex:"0","aria-selected":n})});return r.a.createElement("ul",{className:"pixel-size-container"},a)}}]),t}(n.Component),g=(a(18),b),k=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleClickOnTool=a.handleClickOnTool.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleClickOnTool",value:function(e){(0,this.props.handles.handleSetActiveTool)(e.target.dataset.toolType)}},{key:"render",value:function(){var e=this,t=this.props,a=t.tools,n=t.activeTool,o=a.map(function(t,a){var o=f.kebabCaseToCamelCase(t),i=n===o;return r.a.createElement("li",{onClick:e.handleClickOnTool,className:"lools-list__tool lools-list__tool-".concat(t," ").concat(i?"active":""),"data-tool-type":o,key:a,role:"option",tabIndex:"0","aria-selected":i})});return r.a.createElement("ul",{className:"lools-list"},o)}}]),t}(n.Component),O=(a(19),k),A=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).colorInputs={},a.handleChangeValue=a.handleChangeValue.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleChangeValue",value:function(e,t){(0,this.props.handles.handleSetActiveColors)(Object(p.a)({},t,e.target.value))}},{key:"render",value:function(){var e=this,t=this.props.activeColors,a=Object.keys(t).map(function(a,n){var o="transparent"===t[a];return r.a.createElement("div",{className:"".concat(a,"-color color-icon ").concat(o?"transparent":""),key:n,onClick:function(){return e.colorInputs[a].click()},style:{backgroundColor:t[a]},role:"button",tabIndex:"0"},r.a.createElement("input",{onChange:function(t){return e.handleChangeValue(t,a)},type:"color",value:t[a],className:"input-color hidden",ref:function(t){e.colorInputs[a]=t}}))});return r.a.createElement("div",{className:"color-control-block"},a)}}]),t}(n.Component),F=(a(20),A);a(21);var E=function(e){var t=e.handles,a=t.toolsHandles,n=t.toolArialHandles,o=t.colorControlHandles,i=e.activeModeOpt,l=i.tool,c=i.toolArial,s=e.activeColors;return r.a.createElement("div",{className:"tools-block"},r.a.createElement(g,{handles:n,activeSize:c}),r.a.createElement(O,{handles:a,activeTool:l,tools:["pen","bucket","eraser","color-picker"]}),r.a.createElement(F,{handles:o,activeColors:s}))},D=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).canvas=r.a.createRef(),a.handleClickOnFrame=a.handleClickOnFrame.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.canvas.current,t=this.props.frame,a=e.getBoundingClientRect();e.setAttribute("width",a.width),e.setAttribute("height",a.height),h.paintDefaultScreen(e,t.frameColors.length),h.paintColors(e,t.frameColors)}},{key:"componentDidUpdate",value:function(){var e=this.canvas.current,t=this.props,a=t.frame;t.isActive&&(h.paintDefaultScreen(e,a.frameColors.length),h.paintColors(e,a.frameColors))}},{key:"handleClickOnFrame",value:function(e){var t=this.props.handles,a=t.handleRemoveFrame,n=t.handleDuplicateFrame,r=t.handleSetActiveFrame,o=this.props.frame,i={delete:function(){return a(o)},dublicate:function(){return n(o)},move:function(){},noControls:function(){return r(o)}},l="noControls",c=e.target.className.match(/control-frame-(\w+)/);null!==c&&(l=c[1]),i[l]()}},{key:"render",value:function(){var e=this.props,t=e.isOnlyOneItem,a=e.orderNumber,n=["delete","dublicate","move"].map(function(e,t){return r.a.createElement("button",{type:"button",className:"control-frame-".concat(e," control-frame"),key:t})});return r.a.createElement("div",{className:"frame ".concat(t?"only-one":""),onClick:this.handleClickOnFrame,"data-order-number":a,role:"button",tabIndex:"0"},n,r.a.createElement("canvas",{className:"frame-canvas",ref:this.canvas}))}}]),t}(n.Component),j=(a(22),D);a(23);var I=function(e){var t=e.handles,a=t.frameListHandles,n=t.frameHandles,o=e.frames,i=e.activeFrameID,l=1===o.length,c=o.map(function(e,t){var a=e.frameID===i;return r.a.createElement("li",{className:"preview-frames-list__frame-list-item ".concat(a?"active":""),key:e.frameID},r.a.createElement(j,{handles:n,frame:e,isOnlyOneItem:l,isActive:a,orderNumber:t+1}))});return r.a.createElement("div",{className:"preview-frames-block"},r.a.createElement("ul",{className:"preview-frames-list"},c),r.a.createElement("button",{type:"button",className:"add-new-frame-button",onClick:a.handleAddNewFrame},r.a.createElement("span",{className:"add-new-frame-button__plus-icon"}),r.a.createElement("span",{className:"add-new-frame-button__text"},"Add new frame")))},M=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={fps:0},a.requestAnimationFrameID=null,a.canvas=r.a.createRef(),a.handleChange=a.handleChange.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.canvas.current,t=e.getBoundingClientRect();e.setAttribute("width",t.width),e.setAttribute("height",t.height)}},{key:"componentDidUpdate",value:function(){var e=this.state.fps;cancelAnimationFrame(this.requestAnimationFrameID),0!==e&&this.animateFrames()}},{key:"animateFrames",value:function(){var e=this,t=this.state.fps,a=this.props.frames,n=this.canvas.current;!function(){var r=1e3/t,o=0,i=0,l=e;!function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t-i>=r&&(i=t,h.paintDefaultScreen(n,a[o].frameColors.length),h.paintColors(n,a[o].frameColors),(o+=1)===a.length&&(o=0)),l.requestAnimationFrameID=requestAnimationFrame(e)}()}()}},{key:"handleChange",value:function(e){this.setState({fps:+e.target.value})}},{key:"render",value:function(){var e=this.state.fps;return r.a.createElement("div",{className:"preview-block"},r.a.createElement("div",{className:"animated-canvas-block"},r.a.createElement("canvas",{className:"animation-preview-canvas",ref:this.canvas})),r.a.createElement("div",{className:"fps-control-block"},r.a.createElement("span",{className:"fps-control-text"},r.a.createElement("span",{className:"fps-value"},e),r.a.createElement("span",{className:"fps-text"}," FPS")),r.a.createElement("input",{className:"range-fps",type:"range",value:e,min:"0",max:"24",onChange:this.handleChange})))}}]),t}(n.Component),S=(a(24),M),w=function(e){function t(){var e;Object(l.a)(this,t),e=Object(s.a)(this,Object(u.a)(t).call(this));var a=f.getRandomID();return e.state={pixelCount:16,frames:[{frameColors:h.makeNewMatrix(16),frameID:a}],activeFrameID:a,activeModeOpt:{tool:"pen",toolArial:1},activeColors:{primary:"#00ff00",secondary:"transparent"}},["handleFrameMatrixChange","handleAddNewFrame","handleRemoveFrame","handleDuplicateFrame","handleSetActiveFrame","handleSetActiveTool","handleSetActiveToolArial","handleSetActiveColors"].forEach(function(t){e[t]=e[t].bind(Object(m.a)(e))}),e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleFrameMatrixChange",value:function(e){var t=this.state,a=t.frames,n=t.activeFrameID,r=t.pixelCount,o=a.findIndex(function(e){return e.frameID===n}),i=a.slice();if(Array.isArray(e))e.forEach(function(e){var t=e.pos,a=e.color;i[o].frameColors[t.y][t.x]=a});else if("object"===typeof e){var l=e.specialActionType,c=e.specialActionOpt;({fill:function(e){var t=h.makeNewMatrix(r,e.color);i[o].frameColors=t}})[l](c)}this.setState({frames:i})}},{key:"handleAddNewFrame",value:function(){var e=this.state.pixelCount;this.setState(function(t){var a={frameColors:h.makeNewMatrix(e),frameID:f.getRandomID()},n=t.frames.slice();return n.push(a),{frames:n,activeFrameID:a.frameID}})}},{key:"handleDuplicateFrame",value:function(e){this.setState(function(t){var a=t.frames.findIndex(function(t){return t.frameID===e.frameID}),n=[];e.frameColors.forEach(function(e){return n.push(e.slice())});var r={frameColors:n,frameID:f.getRandomID()};return t.frames.splice(a+1,0,r),{frames:t.frames,activeFrameID:r.frameID}})}},{key:"handleRemoveFrame",value:function(e){var t=this.state,a=t.frames,n=t.activeFrameID,r=a.findIndex(function(t){return t.frameID===e.frameID});a.splice(r,1);var o={frames:a};if(e.frameID===n){var i=0===r?0:r-1;o.activeFrameID=a[i].frameID}this.setState(o)}},{key:"handleSetActiveFrame",value:function(e){this.setState({activeFrameID:e.frameID})}},{key:"handleSetActiveTool",value:function(e){this.setState(function(t){return{activeModeOpt:Object.assign({},t.activeModeOpt,{tool:e})}})}},{key:"handleSetActiveToolArial",value:function(e){this.setState(function(t){return{activeModeOpt:Object.assign({},t.activeModeOpt,{toolArial:e})}})}},{key:"handleSetActiveColors",value:function(e){this.setState(function(t){return{activeColors:Object.assign({},t.activeColors,e)}})}},{key:"render",value:function(){var e={frameHandles:{handleRemoveFrame:this.handleRemoveFrame,handleDuplicateFrame:this.handleDuplicateFrame,handleSetActiveFrame:this.handleSetActiveFrame},frameListHandles:{handleAddNewFrame:this.handleAddNewFrame}},t={toolsHandles:{handleSetActiveTool:this.handleSetActiveTool},colorControlHandles:{handleSetActiveColors:this.handleSetActiveColors},toolArialHandles:{handleSetActiveToolArial:this.handleSetActiveToolArial}},a={handleSetActiveColors:this.handleSetActiveColors,handleFrameMatrixChange:this.handleFrameMatrixChange},n=this.state,o=n.activeModeOpt,i=n.activeColors,l=n.frames,c=n.activeFrameID,s=l.find(function(e){return e.frameID===c});return r.a.createElement("div",{className:"app-wrapper"},r.a.createElement(v,null),r.a.createElement("main",{className:"main"},r.a.createElement(E,{handles:t,activeModeOpt:o,activeColors:i}),r.a.createElement(I,{handles:e,frames:l,activeFrameID:c}),r.a.createElement(y,{handles:a,activeFrame:s,activeModeOpt:o,activeColors:i}),r.a.createElement(S,{frames:l})))}}]),t}(n.Component),x=(a(25),a(26),a(27),w);i.a.render(r.a.createElement(x,null),document.getElementById("root"))}],[[10,1,2]]]);
//# sourceMappingURL=main.71273d02.chunk.js.map